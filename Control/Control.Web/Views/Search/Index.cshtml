@model IEnumerable<Control.Web.Data.Entities.Passanger>

@{
    ViewData["Title"] = "Index";
}


<link rel="stylesheet" href="https://cdn.datatables.net/1.10.19/css/jquery.dataTables.min.css" />
<br />

<h4>Search By Date</h4>
<br />

<section>

    <div class="row">
        <div class="col-lg-12 col-sm-12 col-md-12 col-lg-4 col-xl-4">

           

            <form name="myForm" asp-action="Index" onsubmit="return validateForm()" method="post">

                <div class="form-group">
                    <div class="input-group date">
                        <input name="Fecha" id="Fecha" type="date" class="form-control" pattern="[0-9]{2}/[0-9]{2}/[0-9]{4}" />
                        <span class="input-group-addon">
                            <span class="glyphicon glyphicon-calendar"></span>
                        </span>
                    </div>
                    <span for="Fecha" id="alert" class="text-danger"></span>
                </div>

                <div class="form-group">
                    <button type="submit" class="btn btn-primary"><i class="fa fa-search"></i> Search by Date</button>
                </div>

            </form>
        </div>
    </div>

</section>


<section>
    <div class="row mt-2">
        <div class="col-md-12 text-center">
            <div class="panel panel-default">
                <div class="panel-heading">

                    <h3 class="panel-title">TCP Passanger Count Report <span class="text-danger"> Total: (@Model.Count())</span></h3>                  
                   
                </div>
                <div class="panel-body mx-auto">

                    @if (Model == null || Model.Count() == 0)
                    {
                        <div class="alert alert-warning text-center" role="alert">
                            <strong>No Data</strong>
                            <br />
                            <i class="fas fa-exclamation-triangle fa-2x"></i>
                            <br />
                            <span class="mt-2">Empty Data Base</span>
                        </div>
                    }


                    @*<div class="alert alert-info text-center" role="alert">
            <strong>Load Data</strong>
            <br>
            <i class="fas fa-spinner fa-spin fa-2x"></i>
            <br>
            <span class="mt-2">Please Wait</span>
        </div>*@

                    @if (Model.Count() > 0)
                    {
                        <span class="text-danger">Date: @DateTime.Parse(Model.First().PublishOn.ToString()).ToShortDateString()</span>
                       
                        <br />
                        <table class="table table-hover table-responsive table-striped" id="PassangersTable" show-on-init="false">
                            <thead>
                                <tr>

                                    <th>
                                        @Html.DisplayNameFor(model => model.Flight)
                                    </th>
                                    <th>
                                        @Html.DisplayNameFor(model => model.Adult)
                                    </th>
                                    <th>
                                        @Html.DisplayNameFor(model => model.Child)
                                    </th>
                                    <th>
                                        @Html.DisplayNameFor(model => model.Infant)
                                    </th>
                                    <th>
                                        @Html.DisplayNameFor(model => model.Total)
                                    </th>

                                    <th>
                                        @Html.DisplayNameFor(model => model.ImageUrl)
                                    </th>
                                    <th>
                                        @Html.DisplayNameFor(model => model.User)
                                    </th>

                                    <th>
                                        Actions
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var item in Model)
                                {
                                    <tr>

                                        <td>
                                            @Html.DisplayFor(modelItem => item.Flight)
                                        </td>
                                        <td>
                                            @Html.DisplayFor(modelItem => item.Adult)
                                        </td>
                                        <td>
                                            @Html.DisplayFor(modelItem => item.Child)
                                        </td>
                                        <td>
                                            @Html.DisplayFor(modelItem => item.Infant)
                                        </td>
                                        <td>
                                            @Html.DisplayFor(modelItem => item.Total)
                                        </td>

                                        <td>
                                            @if (!string.IsNullOrEmpty(item.ImageUrl))
                                            {
                                                <img src="@Url.Content(item.ImageUrl)" onerror="this.onerror=null; this.src='/images/no-img.jpg'" alt="Image" style="width:75px;height:75px;max-width: 100%; height: auto;" />
                                            }
                                            else
                                            {
                                                <img src="~/images/no-img.jpg" alt="Image" style="width:75px;height:75px;max-width: 100%; height: auto;" />
                                            }
                                        </td>
                                        <td class="text-nowrap">
                                            @Html.DisplayFor(modelItem => item.User.FullName)
                                        </td>

                                        <td class="text-nowrap">
                                            <a asp-action="Edit" class="btn btn-sm btn-outline-info border-0" asp-route-id="@item.Id"><i class="fa fa-edit"></i> </a>
                                            <a asp-action="Details" class="btn btn-sm btn-outline-success border-0" asp-route-id="@item.Id"><i class="fa fa-list-alt"> </i> </a>
                                            <a asp-action="Delete" class="btn btn-sm btn-outline-danger border-0" asp-route-id="@item.Id"><i class="fa fa-trash-alt"></i> </a>
                                        </td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    }

                </div>
            </div>
        </div>
    </div>
</section>





@section Scripts {
    <script src="//cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script>
    <script type="text/javascript">

        // funcion para Limpiar el Input
        function resetInput() {
            var x = document.getElementById("Fecha");
            x.innerHTML = "dd/MM/yyyy";

        };
        // valida el formulario
        function validateForm() {
            var x, text;
            x = document.forms["myForm"]["Fecha"].value;
            if (x == "") {
                text = "Date not valid";
                document.getElementById("alert").innerHTML = text;
                return false;
            }           

        };

        $(document).ready(function () {
            $('#PassangersTable').DataTable({
                ordering: false
            });            

        });


    </script>
}


